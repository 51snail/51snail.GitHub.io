<!DOCTYPE html>
<html style="font-size: 48px;">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <meta name="format-detection" content="telephone=no">
    <title>通州区图书馆入馆预约</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no,email=no,address=no">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/style/reset.css">
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/style/apps/reserve/reserve.css?20180619">
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/style/apps/reserve/iphonex.css">
    <!--表单采集css-->
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/style/forms/gather/mobile/hind/index.css">
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/style/forms/gather/mobile/hind/common.css">
    <link rel="stylesheet" href="https://office.chaoxing.com/staticreserve/js/lib/jquery/slider/slider.css">
    <link type="text/css" rel="stylesheet"
          href="https://office.chaoxing.com/staticreserve/js/lib/popup/popup.css?t=20180619">
    <script src="https://office.chaoxing.com/staticreserve/js/lib/jquery/v1/jquery.min.js" type="text/javascript" charset="utf-8"></script>
</head>
<body onload="load()">
<div id="reserve_index" class="res_index">
    <ul class="rind_top">
        <li class="rind_tab"><span class="rind_tab_icon tab_icon1"></span>
            <p class="rind_tab_tip">开始预约</p></li>
        <li class="rind_tab"><span class="rind_tab_icon tab_icon3"></span>
            <p class="rind_tab_tip">预约须知</p></li>
        <li class="rind_tab"><span class="rind_tab_icon tab_icon2"></span>
            <p class="rind_tab_tip">我的预约</p></li>
    </ul>
    <div class="rind_cont">
        <div class="rind_now"><h6 class="rind_now_title">当前预约</h6>
            <div class="rind_now_data">
                <div class="rind_now_noData" style="display: none;"><span class="now_noData_icon"></span>
                    <p class="now_noData_tip">暂无预约</p></div>
                <div class="rind_now_list">
                    <div class="rind_now_per">
                        <dl class="now_per_top">
                            <dt>
                                <div class="bx-wrapper" style="max-width: 100%; margin: 0px auto;">
                                    <div class="bx-viewport"
                                         style="width: 100%; overflow: hidden; position: relative; height: 106px;">
                                        <div class="slider1"
                                             style="width: 315%; position: relative; transition-duration: 0s; transform: translate3d(-86px, 0px, 0px);">
                                            <div class="slide bx-clone"
                                                 style="float: left; list-style: none; position: relative; width: 86px;">
                                                <img
                                                        src="http://pan-yz.chaoxing.com/thumbnail/0,0,50/e6c70fb0cc1a712ce0895986edf97480"
                                                        alt="">
                                            </div>
                                            <div class="slide"
                                                 style="float: left; list-style: none; position: relative; width: 86px;">
                                                <img id="now_img"
                                                     src="image/img1.png"
                                                     alt="">
                                            </div>
                                            <div class="slide bx-clone"
                                                 style="float: left; list-style: none; position: relative; width: 86px;">
                                                <img
                                                        src="http://pan-yz.chaoxing.com/thumbnail/0,0,50/e6c70fb0cc1a712ce0895986edf97480"
                                                        alt="">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </dt>
                            <dd><h6 class="now_per_title">成人区域</h6>
                                <p class="now_per_type"><span class="gsyz">待签到</span></p>
                                <p class="now_per_word">预约人 <span>15811391635</span></p>
                                <p class="now_per_word">日期 <span id="now_date">2021-07-22 星期四</span></p>
                                <p class="now_per_word">时间 <span id="now_time">08:30-18:00 9小时30分钟</span></p></dd>
                        </dl>
                        <div class="now_per_btm">
                            <span id="cancel">取消</span>
                            <span class="unlocking" style="display: none;">开锁</span>
                            <span class="sure" onclick="sign()">签到</span></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="rind_near"><h6 class="rind_near_title">最近预约</h6>
            <div class="rind_near_data">
                <div class="rind_near_per"><h6 class="near_per_title">成人区域</h6>
                    <p class="near_per_time">
                        <span id="per_time1" style="margin-left:0rem">2021-06-20 08:30-18:00</span>
                        <span>9小时30分钟</span> <label
                            class="near_per_btn">再次预约</label>
                    </p>
                </div>
                <div class="rind_near_per"><h6 class="near_per_title">成人区域</h6>
                    <p class="near_per_time">
                        <span id="per_time2" style="margin-left:0rem">2021-06-21 08:30-18:00</span>
                        <span>9小时30分钟</span><label
                            class="near_per_btn">再次预约</label>
                    </p>
                </div>
                <!--                <div class="rind_near_per"><h6 class="near_per_title">成人区域</h6>-->
                <!--                    <p class="near_per_time">2021-06-10 08:30-18:00 <span>9小时30分钟</span> <label class="near_per_btn">再次预约</label>-->
                <!--                    </p></div>-->
            </div>
        </div>
        <div class="log_out">退出登录</div> <!----> <!----></div> <!----> <!----></div>
<img src="https://stcs.chaoxing.com/api/stcs/log/add?deptid=97561&amp;uid=140135670&amp;type=3&amp;aid=%202178%20&amp;page=%2Ffront%2Fthird%2Fapps%2Freserve%2Fitem%2Findex&amp;params=%7B%22reserveId%22%3A%222178%22%2C%22resvAppId%22%3A%222178%22%2C%22fidEnc%22%3A%22d05867b45248ce4e%22%2C%22enc%22%3A%22b9422656a063f2d87c351e01bd215c7a%22%2C%22backEnc%22%3A%221%22%7D"
     width="0" height="0">
</body>
<script type="application/javascript">
    Date.prototype.format = function (fmt) {
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    }

    //获取url中的参数
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg);  //匹配目标参数
        if (r != null) return unescape(r[2]); return null; //返回参数值
    }

    function sign() {
        location.href = 'http://sao315.com/w/api/saoyisao?redirect_uri=' + encodeURIComponent(location.origin+"/success.html")
    }

    //获取日期
    function load() {
        // 设置日期
        var myDate = new Date();
        var days = myDate.getDay();
        days = "星期" + "日一二三四五六".charAt(days)
        var str = myDate.format("yyyy-MM-dd") + " " + days;//2021-06-26 星期六
        document.getElementById("now_date").innerText = str;

        // 设置晚自习
        var hours = myDate.getHours();
        if (hours >= 17) {
            document.getElementsByClassName("now_per_title")[0].innerText = "夜间自习";
            document.getElementById("now_time").innerText = "18:00-22:00 4小时";
            //document.getElementById("now_img").src = "http://pan-yz.chaoxing.com/thumbnail/0,0,50/e5c5d0ed80c8478b42a0202f42609203";
        }

        // 设置签到
        var signType = getUrlParam("signType")
        // 未签到
        if (signType == 0 || signType == null) {
            $(".gsyz")[0].innerText = "待签到"
            $("#cancel").show()
            $(".sure")[0].innerText = "签到"
        } else {
            $(".gsyz")[0].innerText = "使用中"
            $("#cancel").hide()
            $(".sure")[0].innerText = "签退"
        }

        // 最近预约
        var offNum = 24 * 60 * 60 * 1000
        if (myDate.getDay() == 2 || myDate.getDay() == 3) {
            offNum = myDate.getDay() * offNum
        }
        var preDay1 = new Date(myDate.getTime() - offNum)
        var preDate1 = preDay1.format("yyyy-MM-dd") + " 08:30-18:00 "
        document.getElementById("per_time1").innerText = preDate1;

        var preDay2 = new Date(preDay1 - 24 * 60 * 60 * 1000).format("yyyy-MM-dd")
        var preDate2 = preDay2 + " 08:30-18:00 "
        document.getElementById("per_time2").innerText = preDate2;
    }


</script>
</html>